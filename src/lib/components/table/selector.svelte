<script lang="ts">
    import { FormState, toggleSelected, FormConfig, AppState } from "$lib/config";

    export let item: any;

    let style: string;
    let showcheck: boolean;

    function included(subs: any, itm: any){
        let selectorStyle: string;
        let ids = [];
        for(const sub of subs){
            ids.push(sub.id)
        }
        if (ids.includes(itm.id)){
            selectorStyle = `border: 2px solid ${$AppState.color}; background: ${$AppState.color}4d;`;
            showcheck = true;
        } else {
            selectorStyle = `border: 2px solid ${$AppState.color}; background: #ffffff00;`;
            showcheck = false;
        }

        return selectorStyle;
    }
    
    $: style = included($FormConfig.subjects, item);
</script>

<!-- svelte-ignore a11y-no-static-element-interactions -->
<!-- svelte-ignore a11y-click-events-have-key-events -->
<td>
{#if $FormState}
    <div {style} class="Selector" />
{:else}
    <div {style} class="Selector" on:click="{()=>toggleSelected(item)}">
    {#if showcheck}
        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15" fill="none">
            <path d="M11.9 3.16885C11.8996 3.15963 11.8399 3.03426 11.7086 3.01557C11.5772 2.99687 11.3704 3.00024 11.3704 3.00024L11.0171 3.01557C10.6941 3.0464 10.5271 3.06354 10.4009 3.09004C10.2964 3.11232 10.2424 3.12711 10.1529 3.15707C10.0398 3.19508 9.9793 3.21799 9.87479 3.26134C9.75453 3.314 9.68609 3.34729 9.57417 3.41774C9.45227 3.49447 9.38886 3.54593 9.28107 3.64116C9.17417 3.73561 9.12089 3.79594 9.02554 3.90183C8.91018 4.02994 8.83642 4.1199 8.74747 4.24442C8.65852 4.36894 8.37321 4.79371 8.37321 4.79371C8.37321 4.79371 8.12571 5.1616 7.95083 5.47328L7.52245 6.20314C7.52245 6.20314 7.30748 6.59628 7.16171 6.84364C7.01956 7.08485 6.96429 7.21566 6.81089 7.47625C6.7326 7.60597 6.38677 8.24166 6.25403 8.45729C6.09459 8.71628 6.03399 8.8488 5.83638 9.11643C5.7465 9.23816 5.60604 9.37771 5.52333 9.33858C5.44063 9.29946 5.30087 9.08187 5.20217 8.90183C5.10348 8.72179 4.98102 8.50953 4.94465 8.43742C4.90827 8.36532 4.70225 8.08922 4.59893 8.02036C4.49562 7.95149 4.44249 7.93233 4.32086 7.90864C4.19122 7.89841 4.12071 7.8979 3.9977 7.90864C3.87994 7.92189 3.81553 7.93503 3.7046 7.97567C3.55734 8.03592 3.47486 8.07985 3.33634 8.17676C3.22792 8.26118 3.17505 8.318 3.09584 8.43742C3.05272 8.53197 3.03201 8.593 3.00566 8.72788C3.00116 8.80734 2.99557 8.86439 3.00566 8.97365C3.02426 9.14807 3.16746 9.3958 3.39646 9.80778C3.52589 10.0508 3.59356 10.1878 3.7046 10.4334C3.81054 10.6562 3.87588 10.7819 3.9977 11.0069C4.05556 11.1067 4.10574 11.1772 4.21565 11.3196C4.29711 11.4186 4.34768 11.4726 4.44863 11.5654C4.56652 11.6514 4.63664 11.6961 4.77179 11.7665C4.9051 11.8298 4.98242 11.8627 5.13253 11.908C5.29605 11.9452 5.38253 11.9593 5.52333 11.9676C5.66604 11.978 5.73875 11.978 5.86153 11.9676C5.96204 11.9572 6.01922 11.9467 6.12457 11.908C6.27156 11.8332 6.34422 11.7833 6.45525 11.6771C6.59298 11.5397 6.67217 11.3918 6.70968 11.3217L6.71078 11.3196C6.74783 11.2504 6.87977 10.9712 6.87977 10.9712C6.87977 10.9712 7.04293 10.588 7.06539 10.5267C7.08785 10.4654 7.20471 10.2185 7.25941 10.128C7.31411 10.0376 7.46233 9.75565 7.46233 9.75565L7.6953 9.33858L7.95083 8.87683L8.274 8.31826C8.274 8.31826 8.53258 7.89469 8.61971 7.77459C8.70683 7.65448 8.86445 7.40729 9.02554 7.15644C9.18663 6.90558 9.13094 6.97558 9.38628 6.61276C9.64163 6.24994 9.88912 5.89738 9.9974 5.75942C10.1057 5.62146 10.6071 4.9701 10.6865 4.87002C10.7658 4.76994 11.2302 4.19152 11.3704 4.0426C11.5105 3.89367 11.5 3.91104 11.7086 3.68585C11.9171 3.46066 11.959 3.34747 11.9 3.16885Z" fill={$AppState.color}/>
        </svg>
    {/if}
    </div>
{/if}
</td>

<style>
    td {
        padding-right: 7px;
    }
    .Selector {
        display: flex;
        box-sizing: border-box;
        justify-content: center;
        align-items: center;
        width: 15px;
        height: 15px;
        border-radius: 5px;
        cursor: pointer;
    }
    svg {
        width: 15px;
        height: 15px;
        flex-shrink: 0;
    }
</style>